clear all 
close all

% Figure 3 replication 

% Theta (rad) 
th = linspace(-pi, pi, 100);

% Choose n = 1 for neo-hookean model

% Fig 3A 
%n = [0.7 1 2 3 10];
% Fig 3B
n = [1.7, 2, 3, 10];


for ii = 1:length(n)
    % Kappa 
    k = 1 - 1/n(ii); 
    
    % omega [dimensionless function]
    w = sqrt(1 - (k*sin(th)).^2);

    % U (dimensionless) 
    U = sin(th./2).*sqrt(1 - (2*(k*cos(th./2)).^2)/(1+w)).*(w+k.*cos(th)).^(k/2);

    figure(1) 
    plot(th, U, 'LineWidth', 2.5)
    hold on 
    
    if n(ii) < 3/2 
        % m
        m = 1 - 1/(2*n(ii));
        % Define cos(xi)
        cosxi = 1/(n(ii)*sqrt(2))*(sqrt(1+k*sin(th).^2 - w.*cos(th))./(w+k.*cos(th)));
        % Find xi 
        xi = acos(cosxi);        
        x = cos(xi).^2;
        % Define hypergeometric function F for anglular function H
        for i = 1:length(x)
            F(i) = hypergeom([1/2 - 1/m, 1/2], 3/2 - 1/m, x(i));
        end
        % Angular Function H(th, n)
        H = (-n(ii)^(5/2)/(m^2)).*(w + k*cos(th)).^(2-m).*((m/(2-m))*F - k*sin(xi)); 
        
        y1 = -U.^2; 
        y2 = real(U); 
    else 
        gamma1 = gamma((2*n(ii)-3)/(2*(2*n(ii)-1)));
        gamma2 = gamma(-1/(2*n(ii)-1));
        H(1) = -(4*n(ii)^(9/2)/(2*n(ii)-1)^2)*n(ii)^(-1-1/2*n(ii))*((2*n(ii)-1)/(2*n(ii)+1))*(sqrt(pi)*gamma1/gamma2);
        H(50) = -(4*n(ii)^(9/2)/(2*n(ii)-1)^2)*(2 - 1/n)^(1+1/2*n)*(1/(n*(2*n+1)));
    end    
    figure(2) 
    if n(ii) < 3/2
        plot(th, H, 'LineWidth', 2.5)
        hold on 
    else 
        plot(th(1), H(1))
        plot(th(50), H(50))
        plot(th(100), H(1))
    end 
end 

%% Plotting
figure(1) 
grid on 
ax = gca; 
ax.XTick = -pi:pi/2:pi;
ax.XTickLabel = {'-\pi','-\pi/2','0','\pi/2','\pi'};
ax.FontSize = 15; 
xlim([-pi pi])
leg = legend(["n = 0.7", "n = 1", "n = 2", "n = 3", "n = 10"], 'Location', 'Best');

figure(2) 
ax.XTick = -pi:pi/2:pi;
ax.XTickLabel = {'-\pi','-\pi/2','0','\pi/2','\pi'};
ax.FontSize = 15; 

figure(3)
hold on     
plot(y1, y2, 'LineWidth', 2.5)
ax = gca; 
% xlim([-0.2 0])
%ylim([0 0.4])
ax.FontSize = 15; 