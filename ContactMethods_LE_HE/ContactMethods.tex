\documentclass[12pt,3p]{article}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
 \usepackage[margin=0.5in]{geometry}
 \usepackage{amsmath}
\usepackage{mathtools}
\usepackage{enumitem}
\usepackage{physics}
\usepackage[round,numbers]{natbib}
\usepackage[colorlinks = false]{hyperref}

\setcounter{tocdepth}{4} 
\setcounter{secnumdepth}{4}

\numberwithin{equation}{section}
\begin{document}

\title{Notes for Contact Methods \\
	\large{Linear Elasticity and Hyperelasticity}}
\author{Ida Ang}
\date{\vspace{-5ex}}
\maketitle

\tableofcontents
\newpage

\section{Problem Definition}
These codes were created to troubleshoot the more advanced code incorporating mass transport, large deformations, and contact. For the contact methods, I recall that Lagrange methods were not sufficient so I do not have much documentation on them. I follow Wriggers closely. 

\section{Formulation}
Equation for strain in terms of displacement
\begin{align}\label{Strain}
\begin{split}
\epsilon_{ij} &= \frac{1}{2} (\pdv{u_i}{x_j} + \pdv{u_j}{x_i}) \\
 \epsilon &= \frac{1}{2} (\nabla u + \nabla u^T)
\end{split}
\end{align}
General expression of the linear elastic isotropic constitutive relationship 
\begin{equation}\label{StressStrain}
\sigma_{ij} = \lambda \epsilon_{kk} \delta_{ij} + 2 \mu \epsilon_{ij}
\end{equation}
This can be inverted to be strain in terms of stress: 
\begin{equation}\label{StrainStress}
\epsilon_{ij} = \frac{1+ \nu}{E} \sigma_{ij} - \frac{v}{E} \sigma_{kk} \delta_{ij}
\end{equation}
where the LamÃ© coefficients are given by: 
\begin{align}\label{lame}
\begin{split}
\lambda &= \frac{E \nu}{(1+ \nu) (1 - 2 \nu)} \\
\mu &= \frac{E}{2 (1+ \nu)}
\end{split}
\end{align}

Starting from the equilibrium equation: 
\begin{align*}
\begin{split}
- Div \sigma = f \quad \rightarrow - \div \sigma &= f \quad \text{Convert to indicial notation} \\
	- \pdv{}{x_k} \mathbf{e_k} \cdot \sigma_{ij} (\mathbf{e_i} \otimes \mathbf{e_j}) &= f_k \mathbf{e_k} \\
	- \pdv{\sigma_{ij}}{x_k} \delta_{ki} \mathbf{e_j} &= f_k \mathbf{e_k} \\
	- \pdv{\sigma_{ij}}{x_i} \mathbf{e_j} &= f_k \mathbf{e_k} \quad \text{Multiply be a test function} \\
	- \pdv{\sigma_{ij}}{x_i} \mathbf{e_j} \cdot v_p \mathbf{e_p} &= f_k \mathbf{e_k} \cdot v_p \mathbf{e_p} \\
	- \pdv{\sigma_{ij}}{x_i} v_p \delta_{jp} &= f_k v_p \delta_{kp} \\
			 - \pdv{\sigma_{ij}}{x_i} v_j &= f_k v_k \quad \text{Integrate over domain} \\
			 - \int_{\Omega} \pdv{\sigma_{ij}}{x_i} v_j dx &= \int_{\Omega} f_k v_k dx \\
\end{split}
\end{align*}
Integration by parts on the LHS 
\begin{align*}
(fg)' = f'g + fg' \rightarrow f'g &= (fg)' - fg' \\
\pdv{\sigma_{ij}}{x_i} v_j &= (\sigma_{ij} v_j)_{,i} - \sigma_{ij} \pdv{v_j}{x_i} 
\end{align*}
Substitute the result from integration by parts: 
\begin{align*}
\begin{split}
- \int_{\Omega} (\sigma_{ij} v_j)_{,i} dx + \int_{\Omega} \sigma_{ij} \pdv{v_j}{x_i} dx &= \int_{\Omega} f_k v_k dx \quad \text{Use the divergence theorem} \\ 
- \int_{\partial \Omega} \sigma_{ij} v_j n_i ds + \int_{\Omega} \sigma_{ij} \pdv{v_j}{x_i} dx &= \int_{\Omega} f_k v_k dx \quad \text{Recognize the traction term} \\
- \int_{\partial \Omega} t_i v_j ds + \int_{\Omega} \sigma_{ij} \pdv{v_j}{x_i} dx &= \int_{\Omega} f_k v_k dx \quad \text{Rearrange} \\
 \int_{\Omega} \sigma_{ij} \pdv{v_j}{x_i} dx &= \int_{\Omega} f_k v_k dx + \int_{\partial \Omega} t_i v_j ds
\end{split}
\end{align*}
The principle of virtual work states that:
\begin{equation}\label{PVW}
\int_{\Omega} \delta W dV = \int_{\Omega} \sigma_{ij} \delta \epsilon_{ij} dV = \int_{\partial \Omega} t_i \delta u_i dS + \int_{\Omega} b_i \delta u_i dV 
\end{equation}
Applying this principle to, where f is  the body force, b: 
\begin{align*}
 \int_{\Omega} \sigma_{ij} \pdv{v_j}{x_i} dx &= \int_{\Omega} f_k v_k dx + \int_{\partial \Omega} t_i v_j ds \\
 \int_{\Omega} \sigma_{ij} \epsilon_{ij} dV &= \int_{\Omega} f_k v_k dx + \int_{\partial \Omega} t_i v_j ds \quad \text{no traction applied} \\
  \int_{\Omega} \sigma_{ij} \epsilon_{ij} dV &= \int_{\Omega} f_k v_k dx
\end{align*}
Writing in direct notation we have the variational (weak) formulation. Find $\mathbf{u} \in V$ such that: 
\begin{equation}\label{weakForm}
\int_{\Omega} \mathbf{ \sigma(u) : \epsilon(v) } d \Omega = \int_{\Omega} \mathbf{ f \cdot v } d \Omega \quad \forall v \in V 
\end{equation}

\section{Contact Methods}
The rigid indenter with a spherical surface can be approximated by a parobolic equation instead of explicitly modeled and meshed. Consider the indenter radius, R, to be sufficiently large with respect to the contact region characteristic size (R $>>$ a). This relationship, R $>>$ a, allows the spherical surface to be approximated by a parabola.
\begin{align}\label{Indenter}
\begin{split}
h(x,z) &= - h_o + \frac{1}{2 R}(x^2 + z^2) \quad \text{about origin} \\
h(x, z) &= - h_o + \frac{1}{2 R}\big[ (x - 0.5)^2 + (z-0.5)^2 \big] \quad \text{about point } (0.5, 0.5)
\end{split}
\end{align}
The definition of the MacKauley bracket:
\begin{align}\label{MacKauley}
\begin{split}
<x> &= \frac{x + |x|}{2} \\
&= 
\begin{dcases}
    0 \text{ for } x \leq 0, \\
    x \text{ for } x > 0
\end{dcases}
\end{split}
\end{align}

\subsection{Penalty Approach}
\subsubsection{Theory}
Adding a penalty term to the energy, $\Pi$.
\begin{align}\label{631}
\begin{split}
\Pi_c^P = \frac{1}{2} \int_{\Gamma_c} \epsilon_N (g_{N})^2 dA \quad \epsilon_N > 0 
\end{split}
\end{align}
Take the variation of Eq. \ref{631}, this holds for pure stick. This is the addition to the weak form: 
\begin{align*}
C_c^P &= \int_{\Gamma_c} \big(\epsilon_N g_{N} \delta g_{N} \big) dA 
\end{align*}

\subsection{Augmented Lagrange Methods}
The main idea of this method is combining the penalty method with Lagrange multiplier methods. 

\subsubsection{Theory}
The augmented Lagrange functional is introduced for normal contact: 
\begin{equation}\label{energyAugLagrange}
l_n = \lambda g + \frac{\epsilon}{2} g^2 - \frac{1}{2 \epsilon} <\lambda + \epsilon g>^2 
\end{equation}
Take the variation of Eq. \ref{energyAugLagrange}
\begin{align*}
\Pi_N^{AM} &= \delta \lambda g + \lambda \delta g + \epsilon g \delta g - \frac{1}{\epsilon}  <\lambda +  \epsilon g> \delta \lambda - <\lambda +  \epsilon g> \delta g \\
		&= g \delta \lambda + (\lambda + \epsilon g) \delta g - \frac{1}{\epsilon}  <\lambda +  \epsilon g> \delta \lambda - <\lambda +  \epsilon g> \delta g \\
		&= g \delta \lambda + \hat{\lambda} \delta g - \frac{1}{\epsilon}  <\hat{\lambda}> \delta \lambda - <\hat{\lambda}> \delta g
\end{align*}
We introduce the following augmented lagrangian term.
\begin{align*}
\hat{\lambda} = \lambda + \epsilon g
\end{align*}
Where for $\hat{\lambda} \leq 0$, we are in contact or penetrating the surface and the gap is 0 or negative. For this case, everything within a Mackauley bracket in the variation goes to zero. 
\begin{align*}
C_N^{AM} &= g \delta \lambda + (\lambda + \epsilon g) \delta g \\
		&= g \delta \lambda + \hat{\lambda} \delta g 
\end{align*}
Next, for $\hat{\lambda} > 0$, we are not in contact, and the gap is positive. 
\begin{align*}
C_N^{AM} &= g \delta \lambda + (\lambda + \epsilon g) \delta g - \frac{1}{\epsilon} (\lambda +  \epsilon g) \delta \lambda - (\lambda +  \epsilon g) \delta g \\
		&= g \delta \lambda - \frac{1}{\epsilon} \lambda \delta \lambda - g \delta \lambda \\
		&= - \frac{1}{\epsilon} \lambda \delta \lambda
\end{align*}
Therefore, summarizing the two cases: 
\begin{align}\label{659}
C_{N}^{AM} &= 
\begin{dcases}
    \int_{\Gamma_c} \bigg( g \delta \lambda + \hat{\lambda} \delta g \bigg) d \Gamma & \text{for } \hat{\lambda}_N \leq 0, \\
    \int_{\Gamma_c} -\frac{1}{\epsilon} \lambda \delta \lambda d \Gamma               & \text{for } \hat{\lambda}_N > 0
\end{dcases}
\end{align}
where $ \hat{\lambda}_N \leq 0$ indicates that the gap is closed and $\hat{\lambda}_N > 0$ means the gap is open. 

\section{Linear Elasticity Formulation}

\section{Hyperelasticity Formulation}

\end{document}